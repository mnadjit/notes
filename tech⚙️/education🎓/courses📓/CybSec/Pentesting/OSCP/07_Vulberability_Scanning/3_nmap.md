---
aliases:
  - Vulnerability Scanning with nmap
tags:
  - tech
  - cybsec
  - offensive_security
  - offsec
  - oscp
  - vulnerability_scanning
  - nmap
  - nse
  - nse_script
author: Mehdi N Tehrani
creat_date: 2023-12-23
category: Cyber Security
subcategory: Offensive Security - OSCP
---

# scripts
The scripts are of the following categories:
[NSE Script Categories](https://subscription.packtpub.com/book/cloud-and-networking/9781782168317/1/ch01lvl1sec11/script-categories)
#nse_script_categories #script_category 
- *default*: same as using `-sC`
- *safe*: Scripts that are considered safe in all situations.
- *vuln*: Scripts related to detecting and exploiting security vulnerabilities.
- *external*: scripts depending on a third-party service
- *intrusive*: scripts that might crash something or generate a lot of network noise. Scripts that system administrators may consider intrusive go here.
- *brute*: scripts that help conduct brute-force password auditing
- *exploit*: Scripts used to exploit security vulnerabilities
- *fuzzer*: scripts focused on fuzzing
- *malware*: scripts related to malware detection
- *version*: advanced version detection
- *dos*: related to DOS attacks
- *broadcast*: scripts that use broadcast petitions to gather network information
- *auth*: related to user authentication


The parameter can be any of the following:
- *category*
- boolean expression
- a comma-separated list of categories
- the full or wildcard-specified name of a NSE script in `script.db` i.e. `/usr/share/nmap/scripts/script.db`
- an absolute path to a specific script.

Syntax
```
nmap -sV --script <param> ...
      ^ activate the Nmap's service detection capabilities

nmap -sV --script "vuln" 
```

#vulners #vulners_script #nmap_vulners_script
A useful feature of the *vulners* script is that it also lists Proof of Concepts for the found vulnerabilities, which are marked with "*EXPLOIT*". However, without a successful service detection, the *vulners* script will not provide any results.

Example:
```
$ sudo nmap -sV --script 'vuln' -p 443 192.168.229.13

PORT    STATE SERVICE VERSION
443/tcp open  http    Apache httpd 2.4.49 ((Unix))
|_http-server-header: Apache/2.4.49 (Unix)
|_http-trace: TRACE is enabled
|_ssl-ccs-injection: No reply from server (TIMEOUT)
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
|_http-dombased-xss: Couldn't find any DOM based XSS.
|_http-csrf: Couldn't find any CSRF vulnerabilities.
| vulners: 
|   cpe:/a:apache:http_server:2.4.49: 
|       PACKETSTORM:171631      7.5     https://vulners.com/packetstorm/PACKETSTORM:171631      *EXPLOIT*
|       PACKETSTORM:164941      7.5     https://vulners.com/packetstorm/PACKETSTORM:164941      *EXPLOIT*
|       PACKETSTORM:164629      7.5     https://vulners.com/packetstorm/PACKETSTORM:164629      *EXPLOIT*
|       PACKETSTORM:164609      7.5     https://vulners.com/packetstorm/PACKETSTORM:164609      *EXPLOIT*
|       MSF:EXPLOIT-MULTI-HTTP-APACHE_NORMALIZE_PATH_RCE-       7.5     https://vulners.com/metasploit/MSF:EXPLOIT-MULTI-HTTP-APACHE_NORMALIZE_PATH_RCE-    *EXPLOIT*
|       MSF:AUXILIARY-SCANNER-HTTP-APACHE_NORMALIZE_PATH-       7.5     https://vulners.com/metasploit/MSF:AUXILIARY-SCANNER-HTTP-APACHE_NORMALIZE_PATH-    *EXPLOIT*
|       FF2EF58E-53AA-5B60-9EA1-4B5C29647395    7.5     https://vulners.com/githubexploit/FF2EF58E-53AA-5B60-9EA1-4B5C29647395  *EXPLOIT*
|       F8A7DE57-8F14-5B3C-A102-D546BDD8D2B8    7.5     https://vulners.com/githubexploit/F8A7DE57-8F14-5B3C-A102-D546BDD8D2B8  *EXPLOIT*
|       F41EE867-4E63-5259-9DF0-745881884D04    7.5     https://vulners.com/githubexploit/F41EE867-4E63-5259-9DF0-745881884D04  *EXPLOIT*
|       EDB-ID:51193    7.5     https://vulners.com/exploitdb/EDB-ID:51193      *EXPLOIT*
|       EDB-ID:50512    7.5     https://vulners.com/exploitdb/EDB-ID:50512      *EXPLOIT*
|       EDB-ID:50446    7.5     https://vulners.com/exploitdb/EDB-ID:50446      *EXPLOIT*
|       EDB-ID:50406    7.5     https://vulners.com/exploitdb/EDB-ID:50406      *EXPLOIT*
|       E81474F6-6DDC-5FC2-828A-812A8815E3B4    7.5     https://vulners.com/githubexploit/E81474F6-6DDC-5FC2-828A-812A8815E3B4  *EXPLOIT*
|       E796A40A-8A8E-59D1-93FB-78EF4D8B7FA6    7.5     https://vulners.com/githubexploit/E796A40A-8A8E-59D1-93FB-78EF4D8B7FA6  *EXPLOIT*
|       E59A01BE-8176-5F5E-BD32-D30B009CDBDA    7.5     https://vulners.com/githubexploit/E59A01BE-8176-5F5E-BD32-D30B009CDBDA  *EXPLOIT*
|       E-739   7.5     https://vulners.com/dsquare/E-739       *EXPLOIT*
|       E-738   7.5     https://vulners.com/dsquare/E-738       *EXPLOIT*
|       D0368327-F989-5557-A5C6-0D9ACDB4E72F    7.5     https://vulners.com/githubexploit/D0368327-F989-5557-A5C6-0D9ACDB4E72F  *EXPLOIT*
|       CVE-2022-31813  7.5     https://vulners.com/cve/CVE-2022-31813
|       CVE-2022-23943  7.5     https://vulners.com/cve/CVE-2022-23943
|       CVE-2022-22720  7.5     https://vulners.com/cve/CVE-2022-22720
|       CVE-2021-44790  7.5     https://vulners.com/cve/CVE-2021-44790
|       CVE-2021-42013  7.5     https://vulners.com/cve/CVE-2021-42013
...
```



# Use nse for a certain CVE
## Download nse from github
`$ sudo wget https://raw.githubusercontent.com/RootUp/PersonalStuff/master/http-vuln-cve-2021-41773.nse -O /usr/share/nmap/scripts/http-vuln-cve-2021-41773.nse`
## update nmap db
#nmap_updatedb
`$ sudo nmap --script-updatedb`

Scan result:
```
PORT    STATE SERVICE VERSION
443/tcp open  http    Apache httpd 2.4.49 ((Unix))
| http-vuln-cve-2021-41773: 
|   VULNERABLE:
|   Path traversal and file disclosure vulnerability in Apache HTTP Server 2.4.49
|     State: VULNERABLE
|               A flaw was found in a change made to path normalization in Apache HTTP Server 2.4.49. An attacker could use a path traversal attack to map URLs to files outside the expected document root. If files outside of the document root are not protected by "require all denied" these requests can succeed. Additionally this flaw could leak the source of interpreted files like CGI scripts. This issue is known to be exploited in the wild. This issue only affects Apache 2.4.49 and not earlier versions.
|           
|     Disclosure date: 2021-10-05
|     Check results:
|       
|         Verify arbitrary file read: https://192.168.229.13:443/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
|       
|     References:
|       https://nvd.nist.gov/vuln/detail/CVE-2021-41773
|_      https://httpd.apache.org/security/vulnerabilities_24.html
|_http-server-header: Apache/2.4.49 (Unix)
```
