---
aliases:
  - Passing NTLM Hashes
tags:
  - tech
  - cybsec
  - offensive_security
  - offsec
  - oscp
  - password
  - password_hash
  - ntlm
  - hash
  - pass_the_hash
  - pth
  - ntlmv2
author: Mehdi N Tehrani
creat_date: 2024-01-01
category: Cyber Security
subcategory: Offensive Security - OSCP
---

# Relay Attack
#relay_attack #smb_relay_attack 
[Microsoft article - Relay Attack](https://learn.microsoft.com/en-us/security-updates/securitybulletins/2008/ms08-068)
In this attack, we use the dir command in the bind shell to create an SMB connection to the attacker machine. We can then forward the NTLMv2 hash to another machine. If the user whose hash we obtained is a local user of that machine, the authentication is valid and therefore accepted by the machine. If the user has *local administrator privileges*, we can use it to authenticate and then *execute commands over SMB* with methods similar to those used by *psexec* or *wmiexec*.

If user does not have admin privileges, for the attack to work, UAC should be disabled on the target.

## ntlmrelayx
#ntlmrelayx_py #ntlmrelayx
[ntlmrelayx GitHub](https://github.com/SecureAuthCorp/impacket/blob/master/examples/ntlmrelayx.py)
- Part of [impacket-scripts](https://www.kali.org/tools/impacket-scripts/)
- [Impacket Github](https://github.com/SecureAuthCorp/impacket)

Command
```sh
impacket-ntlmrelayx --no-http-server -smb2support -t <target> -c <command> 
                      ^ as we're using smb
```


