---
aliases:
  - Password Cracking Fundamentals
tags:
  - tech
  - cybsec
  - offensive_security
  - offsec
  - oscp
  - password
  - password_cracking
author: Mehdi N Tehrani
creat_date: 2023-12-30
category: Cyber Security
subcategory: Offensive Security - OSCP
---
# Introduction

#john_the_ripper #hashcat #opencl #cuda #bcrypt #keyspace 
- JtR (John The Ripper) is more of a CPU-based cracking tool, which also supports GPUs, while Hashcat is mainly a GPU-based cracking tool that also supports CPUs.
- Hashcat requires OpenCL or CUDA for the GPU cracking process.
- Some slow hashing algorithms (like bcrypt) work better on CPUs.
- The *cracking time* can be calculated by dividing the [keyspace](https://www.hypr.com/security-encyclopedia/key-space) with the *hash rate*.

| Algorithm | GPU | CPU |
| --------- | --- | --- |
|MD5 |	68,185.1 MH/s |	450.8 MH/s|
|SHA1 |	21,528.2 MH/s |	298.3 MH/s|
|SHA256 |	9,276.3 MH/s  |	134.2 MH/s|

Increasing *password length* increases cracking duration by *exponential* time
Increasing *password complexity* (charset) only increases cracking duration by *polynomial* time.

# Mutating Wordlists
## Rule-based attacks
#rule_based #password_attacks #rule_based_attacks #hashcat #hashcat_rules
[Hashcat Wiki - rule-based attack rules](https://hashcat.net/wiki/doku.php?id=rule_based_attack)
1. set up rules
```sh
echo $1 > rule
```
2. $1 will add '1' to the end of each word in `passwords.txt`
```sh
hashcat -r rule --stdout passwords.txt
```

### Hashcat rules
#hashcat #hashcat_rules 
```
#    comments
:    do nothing
$a   append 'a'
^b   prepend 'b' 
c    capitalize first letter
t    toggle capitalization of all letters
u    uppercase all letters
l    lowercase all letters
r    reverse the whole word
d    duplicate the whole word
q    duplicate every letter
sXY  replace all X's with Y
@X   purge all X's
[    delete first char
]    delete last char
oNX  overwrite chat at position N with X
ONM  delete M chars starting at position N
xNM  extract M chars at position N (keep only those extracted and delete the rest)
*NM  swap char at position N with char at position M
+N   increment char at position N by 1 ascii value
-N   decrement char at position N by 1 ascii value
DN   delete char at position N
zN   duplicate first char N times
ZN   duplicate last char N times
'N   truncate at position N
pN   apend duplicated word N times
```

# Cracking Methodology
Process:
1. Extract hashes
2. Format hashes
3. Calculate the cracking time
4. Prepare wordlist
	- In nearly all cases we should mutate our wordlist and perform a rule-based attack, instead of a straight dictionary attack.
	- investigate potential password policies 
	- research other password vectors, including online password leak sites
1. Attack the hash

