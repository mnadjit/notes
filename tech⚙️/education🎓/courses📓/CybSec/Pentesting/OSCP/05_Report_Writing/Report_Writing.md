---
aliases:
  - Penetration Testing Report Writing
tags:
  - tech
  - cybsec
  - offensive_security
  - offsec
  - oscp
  - report
  - report_writing
  - penetration_testing
  - pentest
  - pentesting
author: Mehdi N Tehrani
creat_date: 2024-01-08
category: Cyber Security
subcategory: Offensive Security - OSCP
---

# Purpose of a technical report
First understand:
1. The purpose of the report
2. How we can deliver the information we've collected in a way that the audience can understand.

The end goal is for the client to be presented with a path forward that outlines and highlights:
- all the flaws that are currently present in their systems within the scope of the engagement
- ways to fix those flaws in an immediate sense
- strategic goals that will prevent those vulnerabilities from appearing in the future

In many cases where we don't find vulnerabilities, we should avoid including too many technical details on what we did in the report. A simple statement that no vulnerabilities have been found is often sufficient. Unless client requests verbose report.

Try to get a deep understanding of what would cause concern to the client in the event of an attack. In other words, understanding their key business goals and objectives.

# Tailor the content
We want to not only provide a simple overview of the issues for the executives, but we will also want to provide sufficient technical detail for the more technical readers.

Factors to consider:
- our relationship with the client
- their size
- budget
- maturity

Two audiences:
1. the more important, is the management level. Depending on the business, this may be C-level functions (CISO, CSO, CFO, etc), or department heads of IT or security.
2. technical staff
# Executive Summary
> First part of the report

- Start with outlining the *scope of the engagement*
	- what exactly was tested and whether anything was dropped from the scope
	- *Timing issues*, such as insufficient testing time due to finding too many vulnerabilities to adequately report on, should be included
- Time frame of the test
	- the length of time spent on testing, the dates, and potentially the testing hours as well.
- Rules of Engagement
	- if a referee was part of the testing team. 
	- If denial of service testing was allowed
	- if social engineering was encouraged
	- If we followed a specific testing methodology, we should also indicate that here.
- supporting infrastructure and accounts
	- if we were given user accounts by the client, include them here along with the IP addresses that the attacks came from (i.e our testing machines)
	- note any accounts that we created so the client can confirm they have been removed

- Example of an *Executive Summary*:
	- Scope: https://kali.org/login.php
	- Timeframe: Jan 3-5, 2022
	- OWASP/PCI Testing methodology was used
	- Social engineering and DoS testing were not in scope
	- No testing accounts were given; testing was black box from an external IP address
	- All tests were run from `192.168.1.2`

## Long-form Executive Summary
- A written summary of the testing that provides a high-level overview of each step of the engagement and establishes severity, context, and a "worst-case scenario" for the key findings from the testing.
- make note of any trends that were observed in the testing to provide strategic advice
- group findings with similar vulnerabilities
- mention things that the client has done well
- conclude with an engagement wrap-up

Not all penetration testers will offer remediation advice, and not all clients will expect it.

# Testing environment considerations
Detail any issues that affected the testing in a fairly small section.
inform the client of all circumstances and limitations that affected the engagement

- *Positive Outcome*: "There were no limitations or extenuating circumstances in the engagement. The time allocated was sufficient to thoroughly test the environment."
- *Neutral Outcome*: "There were no credentials allocated to the tester in the first two days of the test. However, the attack surface was much smaller than anticipated. Therefore, this did not have an impact on the overall test. OffSec recommends that communication of credentials occurs immediately before the engagement begins for future contracts, so that we can provide as much testing as possible within the allotted time."
- *Negative Outcome*: "There was not enough time allocated to this engagement to conduct a thorough review of the application, and the scope became much larger than expected. It is recommended that more time is allocated to future engagements to provide more comprehensive coverage."

# Technical summary
A list of all of the key findings in the report, written out with a summary and recommendation for a technical person, like a security architect, to learn at a glance what needs to be done.

An example of the structure of this section might be:

- User and Privilege Management
- Architecture
- Authorization
- Patch Management
- Integrity and Signatures
- Authentication
- Access Control
- Audit, Log Management and Monitoring
- Traffic and Data Encryption
- Security Misconfigurations

Example:
4. Patch Management
Windows and Ubuntu operating systems that are not up to date were identified. These are shown to be vulnerable to publicly-available exploits and could result in malicious execution of code, theft of sensitive information, or cause denial of services which may impact the infrastructure. Using outdated  applications increases the possibility of an intruder gaining unauthorized access by exploiting known vulnerabilities. Patch management ought to be improved and updates should be applied in conjunction with change management.

## Risk heat map
The section should finish with a risk heat map based on *vulnerability severity adjusted as appropriate to the client's context*, and as agreed upon with a client security risk representative if possible.

# Technical findings and recommendations
- where we include the full technical details relating to our penetration test, and what we consider to be the appropriate steps required to address the findings
- a broad overview of how it was able to take place should usually be provided
- often presented in tabular form and provides full details of the findings
- might cover one vulnerability that has been identified, or may cover multiple vulnerabilities of the same type
- might be a need for an *attack narrative*
	- in story format, exactly what happened during the test
	- done for a simulated threat engagement
	- also useful at times to describe the more complex exploitation steps required for a regular penetration test
- An extended narrative could be placed in an Appendix and referenced from the findings table.


## example
| Ref | Risk | Issue Description and Implications                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Recommendations |
| --- | ---- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------- |
| 1   | H    | Account, Password, and Privilege Management is inadequate. Account management is the process of provisioning new accounts and removing accounts that are no longer required. The following issues were identified by performing an analysis of 122,624 user accounts post-compromise: 722 user accounts were configured to never expire; 23,142 users had never logged in; 6 users were members of the domain administrator group; default initial passwords were in use for 968 accounts. | All accounts should have passwords that are enforced by a strict policy. All accounts with weak passwords should be forced to change them. All accounts should be set to expire automatically. Accounts no longer required should be removed.                |
| 2   | H    | Information enumerated through an anonymous SMB session. An anonymous SMB session connection was made, and the information gained was then used to gain unauthorized user access as detailed in Appendix E.9.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | To prevent information gathering via anonymous SMB sessions: Access to TCP ports 139 and 445 should be restricted based on roles and requirements. Enumeration of SAM accounts should be disabled using the Local Security Policy > Local Policies > Security Options                |
| 3   | M    | Malicious JavaScript code can be run to silently carry out malicious activity. A form of this is reflected cross-site scripting (XSS), which occurs when a web application accepts user input with embedded active code and then outputs it into a webpage that is subsequently displayed to a user. This will cause attacker-injected code to be executed on the user's web browser. XSS attacks can be used to achieve outcomes such as unauthorized access and credential theft, which can in some cases result in reputational and financial damage as a result of bad publicity or fines. As shown in Appendix E.8, the [client] application is vulnerable to an XSS vulnerability because the username value is displayed on the screen login attempt fails. A proof-of-concept using a maliciously crafted username is provided in Appendix E.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Treat all user input as potentially tainted, and perform proper sanitization through special character filtering. Adequately encode all user-controlled output when rendering to a page. Do not include the username in the error message of the application login.                |

## Technical vs business risk
what we identify as the severity of an issue based on its vulnerability score is not context-specific business risk. It only represents technical severity, even if we adjust it based on likelihood. Or we can work with the client to get an understanding of the business level risk too.

## Finding Description
- We can start our findings description with a sentence or two describing what the vulnerability is, why it is dangerous, and what an attacker can accomplish with it.
- then describe some of the technical details about the vulnerability
- Include *evidence to prove vulnerability*
	- if long and cannot be included inline, then in appendix
- include *screehshots*
- *remediation advice*: detailed enough to enable system and application administrators to implement it without ambiguity
- *means of replicating findings*
- Multiple areas affected
	- we should include a reference to each area. If there is a large number of similar issues, then it's often acceptable to provide samples with a caveat that these are not the only areas where the issue occurs.

### Avoid
- *Broad solutions* should be avoided, in favor of things that drill down into the specifics of the application and the business
- *Theoretical solutions* are not effective in combating a vulnerability
	- Make sure that any solution given has a concrete and practical implementation
- Do not layer *multiple steps into one proposed solution*.

# Appendices, resources, and references
- Things that go here typically do not fit anywhere else in the report
- or are too lengthy or detailed to include inline. 
	- This includes long lists of compromised users or affected areas, large proof-of-concept code blocks, expanded methodology or technical write-ups, etc

## Further Information Section
- articles that describe the vulnerability in more depth
- standards for the remediation recommendation for the client to follow
- other methods of exploitation
## References
ensure to only use the most authoritative sources, and we should also ensure that we cite them properly

