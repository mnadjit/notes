
IP: `192.168.229.10`
# nmap
```
PORT    STATE SERVICE      VERSION
135/tcp open  msrpc        Microsoft Windows RPC
139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp open  microsoft-ds Windows 10 Pro 15063 microsoft-ds (workgroup: WORKGROUP)
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running (JUST GUESSING): Microsoft Windows 11|10 (88%), FreeBSD 6.X (85%)
OS CPE: cpe:/o:freebsd:freebsd:6.2 cpe:/o:microsoft:windows_10
Aggressive OS guesses: Microsoft Windows 11 21H2 (88%), FreeBSD 6.2-RELEASE (85%), Microsoft Windows 10 (85%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 4 hops
Service Info: Host: REMOTEMOUSE; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required
| smb-os-discovery: 
|   OS: Windows 10 Pro 15063 (Windows 10 Pro 6.3)
|   OS CPE: cpe:/o:microsoft:windows_10::-
|   Computer name: remotemouse
|   NetBIOS computer name: REMOTEMOUSE\x00
|   Workgroup: WORKGROUP\x00
|_  System time: 2023-12-29T00:08:50-08:00
| smb2-time: 
|   date: 2023-12-29T08:08:53
|_  start_date: 2023-06-16T03:40:24
|_clock-skew: mean: 2h40m02s, deviation: 4h37m09s, median: 1s
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
1978/tcp  open  unisql
49664/tcp open  unknown
49665/tcp open  unknown
49666/tcp open  unknown
49667/tcp open  unknown
49672/tcp open  unknown
49673/tcp open  unknown
49674/tcp open  unknown
```

# smb
```
$ smbclient -L //192.168.229.10  
Password for [WORKGROUP\kali]:

        Sharename       Type      Comment
        ---------       ----      -------
        ADMIN$          Disk      Remote Admin
        C$              Disk      Default share
        IPC$            IPC       Remote IPC
        offsec          Disk      
        Users           Disk      
```

## nmap
```
PORT    STATE SERVICE      VERSION
135/tcp open  msrpc        Microsoft Windows RPC
139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp open  microsoft-ds Windows 10 Pro 15063 microsoft-ds (workgroup: WORKGROUP)
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running (JUST GUESSING): Microsoft Windows 11|10 (88%), FreeBSD 6.X (85%)
OS CPE: cpe:/o:freebsd:freebsd:6.2 cpe:/o:microsoft:windows_10
Aggressive OS guesses: Microsoft Windows 11 21H2 (88%), FreeBSD 6.2-RELEASE (85%), Microsoft Windows 10 (85%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 4 hops
Service Info: Host: REMOTEMOUSE; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_smb-vuln-ms10-054: false
|_smb-print-text: false
| smb-protocols: 
|   dialects: 
|     NT LM 0.12 (SMBv1) [dangerous, but default]
|     2:0:2
|     2:1:0
|     3:0:0
|     3:0:2
|_    3:1:1
| smb-mbenum: 
|_  ERROR: Call to Browser Service failed with status = 2184
| smb2-capabilities: 
|   2:0:2: 
|     Distributed File System
|   2:1:0: 
|     Distributed File System
|     Leasing
|     Multi-credit operations
|   3:0:0: 
|     Distributed File System
|     Leasing
|     Multi-credit operations
|   3:0:2: 
|     Distributed File System
|     Leasing
|     Multi-credit operations
|   3:1:1: 
|     Distributed File System
|     Leasing
|_    Multi-credit operations
|_smb-vuln-ms10-061: ERROR: Script execution failed (use -d to debug)
| smb2-time: 
|   date: 2023-12-29T08:11:30
|_  start_date: 2023-06-16T03:40:24
| smb-brute: 
|_  guest:<blank> => Valid credentials
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_smb-flood: ERROR: Script execution failed (use -d to debug)
| smb-enum-shares: 
|   account_used: guest
|   \\192.168.229.10\ADMIN$: 
|     Type: STYPE_DISKTREE_HIDDEN
|     Comment: Remote Admin
|     Anonymous access: <none>
|     Current user access: <none>
|   \\192.168.229.10\C$: 
|     Type: STYPE_DISKTREE_HIDDEN
|     Comment: Default share
|     Anonymous access: <none>
|     Current user access: <none>
|   \\192.168.229.10\IPC$: 
|     Type: STYPE_IPC_HIDDEN
|     Comment: Remote IPC
|     Anonymous access: READ/WRITE
|     Current user access: READ/WRITE
|   \\192.168.229.10\Users: 
|     Type: STYPE_DISKTREE
|     Comment: 
|     Anonymous access: READ
|     Current user access: READ
|   \\192.168.229.10\offsec: 
|     Type: STYPE_DISKTREE
|     Comment: 
|     Anonymous access: READ
|_    Current user access: READ/WRITE
| smb-os-discovery: 
|   OS: Windows 10 Pro 15063 (Windows 10 Pro 6.3)
|   OS CPE: cpe:/o:microsoft:windows_10::-
|   Computer name: remotemouse
|   NetBIOS computer name: REMOTEMOUSE\x00
|   Workgroup: WORKGROUP\x00
|_  System time: 2023-12-29T00:16:56-08:00
| smb-ls: Volume \\192.168.229.10\Users
|   maxfiles limit reached (10)
| SIZE   TIME                 FILENAME
| <DIR>  2017-03-18T11:40:20  .
| <DIR>  2017-03-18T11:40:20  ..
| <DIR>  2022-06-21T01:06:55  offsec
| <DIR>  2022-06-21T01:07:23  offsec\Contacts
| <DIR>  2022-06-21T01:06:55  offsec\Desktop
| <DIR>  2022-06-21T01:06:55  offsec\Documents
| <DIR>  2022-06-21T01:06:55  offsec\Downloads
| <DIR>  2022-06-21T01:06:55  offsec\Favorites
| <DIR>  2022-06-21T01:06:55  offsec\Links
| <DIR>  2022-06-21T01:06:55  offsec\Music
| 
| 
| Volume \\192.168.229.10\offsec
|   maxfiles limit reached (10)
| SIZE      TIME                 FILENAME
| <DIR>     2022-06-21T01:06:55  .
| <DIR>     2022-06-21T01:06:55  ..
| <DIR>     2022-06-21T01:07:23  Contacts
| <DIR>     2022-06-21T01:06:55  Desktop
| 38        2022-10-11T14:14:44  Desktop\flag.txt
| <DIR>     2022-06-21T01:06:55  Documents
| <DIR>     2022-06-21T01:06:55  Downloads
| 1569243   2022-06-21T21:56:34  Downloads\7z2200-x64.exe
| 49618184  2022-06-21T21:54:23  Downloads\ccsetup601.exe
| 1414600   2022-06-21T21:53:48  Downloads\ChromeSetup.exe
|_
| smb-vuln-ms08-067: 
|   VULNERABLE:
|   Microsoft Windows system vulnerable to remote code execution (MS08-067)
|     State: LIKELY VULNERABLE
|     IDs:  CVE:CVE-2008-4250
|           The Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2,
|           Vista Gold and SP1, Server 2008, and 7 Pre-Beta allows remote attackers to execute arbitrary
|           code via a crafted RPC request that triggers the overflow during path canonicalization.
|           
|     Disclosure date: 2008-10-23
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4250
|_      https://technet.microsoft.com/en-us/library/security/ms08-067.aspx
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required

```

## Attack
open port `tcp:1978` and the hostname `remotemouse` indicate that remote mouse is running on the machine
- Metasploit: `windows/misc/wifi_mouse_rce`
	- https://www.exploit-db.com/exploits/50972
