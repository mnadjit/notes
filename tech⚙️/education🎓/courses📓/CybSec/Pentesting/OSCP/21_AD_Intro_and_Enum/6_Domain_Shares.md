---
aliases:
  - Active Directory Enumeration - Domain Shares
tags:
  - tech
  - cybsec
  - offensive_security
  - offsec
  - oscp
  - active_directory
  - ad
  - adds
  - domain_shares
  - shares
author: Mehdi N Tehrani
creat_date: 2024-01-06
category: Cyber Security
subcategory: Offensive Security - OSCP
---

# Get Domain Shares
#powerview 
```powershell
Find-DomainShare

Name           Type Remark                 ComputerName
----           ---- ------                 ------------
ADMIN$   2147483648 Remote Admin           DC1.corp.com
C$       2147483648 Default share          DC1.corp.com
IPC$     2147483651 Remote IPC             DC1.corp.com
NETLOGON          0 Logon server share     DC1.corp.com
[...]
```

Only those current user has access to:
#check_share_access #checkshareaccess
```powershell
$shared = Find-DomainShare -CheckShareAccess
```


# Other info
## SysVol Folder 
#sysvol 
[Microsoft Article](https://social.technet.microsoft.com/wiki/contents/articles/24160.active-directory-back-to-basics-sysvol.aspx)
- Typically used for various domain policies and scripts. 
- By default, the SYSVOL folder is mapped to `%SystemRoot%\SYSVOL\Sysvol\domain-name` on the domain controller
- **Every domain user has access to it**

## gpp
#gpp #group_policy_preferences

Historically, system administrators often changed local workstation passwords through Group Policy Preferences (GPP)
[GPP - Microsoft article](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/dn581922(v=ws.11))
 Even though GPP-stored passwords are encrypted with AES-256, the private key for the encryption has been [posted on MSDN](https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-gppref/2c15cbf0-f086-4c74-8b70-1f2fa45dd4be?redirectedfrom=MSDN#endNote2).

### tool
#password_attack #gpp_decrypt #ruby
[gpp-decrypt kali tool](https://www.kali.org/tools/gpp-decrypt/)
`gpp-decrypt` ruby script found in kali
```sh
$ gpp-decrypt $gpp_string

$ gpp-decrypt "+bsY0V3d4/KgX3VJdO/vyepPfAN1zMFTiQDApgR92JE"
P@$$w0rd
```
