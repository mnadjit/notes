---
aliases:
  - Scheduled Tasks
tags:
  - tech
  - cybsec
  - offensive_security
  - offsec
  - oscp
  - windows
  - privesc
  - privilege_escalation
  - scheduled_tasks
  - task_scheduler
  - tasks
author: Mehdi N Tehrani
creat_date: 2024-01-02
category: Cyber Security
subcategory: Offensive Security - OSCP
---

# Is the task a privesc vector?

1. As which *user account* (principal) does this task get executed?
2. What *triggers* are specified for the task?
3. What *actions* are *executed* when one or more of these triggers are met?

# Get Tasks 
## All scheduled tasks
```cmd
schtasks /query /fo LIST /v
```

```powershell
Get-ScheduledTask 
```
## Filtered list of tasks
```powershell
schtasks /query /fo list /v | select-string -Pattern 'Task to' | select-string -NotMatch 'C:\\Win|COM|%windir%|%systemroot%'
```
#get_scheduledtask
```powershell
Get-ScheduledTask | select author,taskname,triggers,actions -exp triggers | select -exp actions -pro author,taskname,@{n='interval';e={$_.repetition.Interval}} -exc arguments,id | select execute,taskname,interval,author,arguments |?{$_.execute -notmatch 'windir|systemroot|windows'}| ft
```

## Important properties
- TaskName
- Next Run Time
- Last Run Time
- Author
- Run as User
- Task to Run

# Check permissions to task
```
icacls <binary_path>
```
