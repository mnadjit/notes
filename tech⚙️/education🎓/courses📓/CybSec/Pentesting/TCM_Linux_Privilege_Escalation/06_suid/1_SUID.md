---
aliases: SUID (Set User ID)
tags:
  - tech
  - cybsec
  - linux
  - privilege_escalation
  - privesc
  - suid
  - set_user_id
author: Mehdi N Tehrani
creat_date: 2023-12-17
category: Cyber Security
subcategory: Linux SUID
---

# References
[Red Hat Audit Permissions find](https://www.redhat.com/sysadmin/audit-permissions-find)
[man 1 find](https://www.man7.org/linux/man-pages/man1/find.1.html)

```
# SUID
find / -perm  4755
             ^ no prefixes mean EXACTLY this set of permission bits mode are set
# GUID
find / -perm 2755
# sticky bit
find / -perm /1444
             ^ '/' means ANY of the permission bits mode are set

# other examples
find / -perm 06111      # exact match; suid AND sgid are both set and all have only read permission (a+x)
find / -perm /06000     # either suid is set OR sgid is set
find / -perm -04000     # at least suid is set 
find / -perm +04000     # deprecated; same as / 
```
most files of interest are in `/usr` directory. if takes too long on root dir `/`, try `/usr`
# Find files with SUID set
```
find / -perm -u=s -type f 2>/dev/null
```


# CHMOD man page
[man 1 chmod](https://www.man7.org/linux/man-pages/man1/chmod.1.html)
[man 2 chmod](https://www.man7.org/linux/man-pages/man2/chmod.2.html)
## SETUID AND SETGID BITS
**chmod** clears the set-group-ID bit of a regular file if the file's group ID does not match the user's effective group ID or one of the user's supplementary group IDs, unless the user has appropriate privileges.  Additional restrictions may cause the set-user-ID and  set-group-ID  bits  of MODE or RFILE to be ignored.  This behavior depends on the policy and functionality of the underlying chmod system call.  When in doubt, check the underlying system behavior.

For directories chmod preserves set-user-ID and set-group-ID bits unless you explicitly specify otherwise.  You can set or clear the bits with symbolic modes like `u+s` and `g-s`. To clear  these  bits for  directories  with  a numeric mode requires an additional leading zero like `00755`, leading minus like `-6000`, or leading equals like ` =755`.
## RESTRICTED DELETION FLAG OR STICKY BIT
The restricted deletion flag or sticky bit is a single bit, whose interpretation depends on the file
type. For directories, it prevents unprivileged users from removing or renaming a file in the directory  unless  they own the file or the directory; this is called the restricted deletion flag for the directory, and is commonly found on world-writable directories like `/tmp`. For regular files on some older systems, the bit saves the program's text image on the swap device so it will load more quickly when run; this is called the sticky bit.
