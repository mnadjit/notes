<div class="mat-elevation-z8 div-main-table">
  <table mat-table matSort multiTemplateDataRows [dataSource]="datasource" class="mat-elevation-z8">
    <ng-container matColumnDef="mrn" >
      <th mat-header-cell *matHeaderCellDef mat-sort-header> UR </th>
      <td mat-cell *matCellDef="let message"> {{ message.mrn }}
        <!-- <mat-icon matTooltip="View Content" class="view-message-content" (click)="ViewMessageContent($event, message)">markunread</mat-icon> -->
      </td>
    </ng-container>

    <ng-container matColumnDef="messageDateTime" >
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Message DateTime </th>
      <td mat-cell *matCellDef="let message"> {{ message.messageDateTime | date:"yyyy-MM-dd HH:mm:ss" }} </td>
    </ng-container>

    <ng-container matColumnDef="messageCode" >
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Message Code </th>
      <td mat-cell *matCellDef="let message"> {{ message.messageCode }} </td>
    </ng-container>

    <ng-container matColumnDef="triggerEvent" >
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Trigger Event </th>
      <td mat-cell *matCellDef="let message"> {{ message.triggerEvent }} </td>
    </ng-container>

    <ng-container matColumnDef="sendingApplication" >
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Sender </th>
      <td mat-cell *matCellDef="let message"> {{ message.sendingApplication }} ({{ message.sendingFacility }}) </td>
    </ng-container>

    <ng-container matColumnDef="receivingApplication" >
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Receiver </th>
      <td mat-cell *matCellDef="let message"> {{ message.receivingApplication }} ({{ message.receivingFacility }}) </td>
    </ng-container>

    <ng-container matColumnDef="insertDateTime" >
      <th mat-header-cell *matHeaderCellDef mat-sort-header> DB Inserted DateTime </th>
      <td mat-cell *matCellDef="let message"> {{ message.insertDateTime | date:"yyyy-MM-dd HH:mm:ss" }} </td>
    </ng-container>

    <ng-container matColumnDef="messageControlId" >
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Message Control Id </th>
      <td mat-cell *matCellDef="let message"> {{ message.messageControlId }} </td>
    </ng-container>

    <ng-container matColumnDef="processingId" >
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Processing Id </th>
      <td mat-cell *matCellDef="let message"> {{ message.processingId }} </td>
    </ng-container>

    <ng-container matColumnDef="versionId" >
      <th mat-header-cell *matHeaderCellDef mat-sort-header> HL7 Versoin </th>
      <td mat-cell *matCellDef="let message"> {{ message.versionId }} </td>
    </ng-container>

    <ng-container matColumnDef="direction" >
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Direction </th>
      <td mat-cell *matCellDef="let message"> {{ message.direction }} </td>
    </ng-container>

    <ng-container matColumnDef="messageSizeBytes" >
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Message Size (Bytes) </th>
      <td mat-cell *matCellDef="let message"> {{ message.messageSizeBytes }}</td>
    </ng-container>

    <ng-container matColumnDef="expandedDetail">
      <td mat-cell *matCellDef="let message" [attr.colspan]="displayedColumns.length">
        <div class="message-detail" [@detailExpand]="message == expandedMessage ? 'expanded' : 'collapsed'">
          <div class="message-content-container" >
            <div [innerHTML]="message.messageContent"></div>
          </div>
        </div>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let message; columns: displayedColumns;"
      class="message-content-row"
      [class.message-content-row]="expandedMessage === message"
      (click)="GetMessageContent(message)">
    </tr>
    <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="message-detail-row"></tr>
  </table>

  <mat-paginator [pageSizeOptions]="[35, 70, 150]" showFirstLastButtons></mat-paginator>
</div>
